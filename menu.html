<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Men√∫ - Ordena Aqu√≠</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    /* Estilos personalizados b√°sicos */
    .custom-navbar {
      background-color: #f8f9fa;
    }
    .navbar-title {
      font-weight: 700;
      color: #333;
    }
    #contenedor-productos .card {
      cursor: pointer;
      transition: transform 0.2s ease-in-out;
    }
    #contenedor-productos .card:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body class="container py-4">

  <nav class="navbar custom-navbar mb-4 p-3 shadow-sm d-flex align-items-center">
    <h2 class="navbar-title mb-0 mx-auto">ORDENA AQU√ç</h2>
    <div id="saludoUsuario" class="navbar-text ms-auto"></div>
    <button class="btn position-relative ms-3" data-bs-toggle="modal" data-bs-target="#modalOrden" aria-label="Ver carrito de pedidos">
      üõçÔ∏è
      <span id="contadorOrden" class="badge bg-danger rounded-pill position-absolute top-0 start-100 translate-middle">0</span>
    </button>
  </nav>

  <div id="contenedor-productos" class="row row-cols-1 row-cols-md-3 g-4"></div>

  <!-- Modal de Orden -->
  <div class="modal fade" id="modalOrden" tabindex="-1" aria-labelledby="modalOrdenLabel" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalOrdenLabel">Tu Pedido</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <ul id="detalleOrden" class="list-group mb-3"></ul>
          <p id="mensajeVacio" class="text-center text-muted">No hay productos en tu pedido.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          <button id="btnEnviarMesero" type="button" class="btn btn-primary" disabled>Enviar al mesero</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Edici√≥n -->
  <div class="modal fade" id="modalEditar" tabindex="-1" aria-labelledby="modalEditarLabel" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body" id="modalEditarContenido">
          <!-- Contenido din√°mico para editar producto -->
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Script principal -->
  <script>
    // Datos ejemplo de productos
    const productos = [
      { id: 1, nombre: 'Pizza Margarita', precio: 120, descripcion: 'Pizza cl√°sica con queso y tomate.' },
      { id: 2, nombre: 'Hamburguesa', precio: 90, descripcion: 'Hamburguesa con queso, lechuga y tomate.' },
      { id: 3, nombre: 'Ensalada C√©sar', precio: 70, descripcion: 'Lechuga, crutones, pollo y aderezo C√©sar.' },
      { id: 4, nombre: 'Agua Mineral', precio: 20, descripcion: 'Botella de agua mineral fresca.' },
      { id: 5, nombre: 'Refresco Cola', precio: 25, descripcion: 'Refresco sabor cola en lata.' },
      { id: 6, nombre: 'Caf√© Americano', precio: 40, descripcion: 'Caf√© negro filtrado, caliente.' }
    ];

    // Carrito de pedidos (array de objetos con producto y cantidad)
    let carrito = [];

    const contenedorProductos = document.getElementById('contenedor-productos');
    const detalleOrden = document.getElementById('detalleOrden');
    const mensajeVacio = document.getElementById('mensajeVacio');
    const contadorOrden = document.getElementById('contadorOrden');
    const btnEnviarMesero = document.getElementById('btnEnviarMesero');

    // Funci√≥n para mostrar productos en el men√∫
    function mostrarProductos() {
      contenedorProductos.innerHTML = '';
      productos.forEach(producto => {
        const card = document.createElement('div');
        card.className = 'col';
        card.innerHTML = `
          <div class="card h-100 shadow-sm" role="button" tabindex="0" aria-label="Agregar ${producto.nombre} al pedido">
            <div class="card-body">
              <h5 class="card-title">${producto.nombre}</h5>
              <p class="card-text">${producto.descripcion}</p>
              <p class="card-text fw-bold">$${producto.precio.toFixed(2)}</p>
            </div>
          </div>
        `;
        // Agregar evento para agregar al carrito al hacer click en la tarjeta
        card.querySelector('.card').addEventListener('click', () => agregarAlCarrito(producto.id));
        contenedorProductos.appendChild(card);
      });
    }

    // Funci√≥n para agregar producto al carrito
    function agregarAlCarrito(idProducto) {
      const producto = productos.find(p => p.id === idProducto);
      if (!producto) return;
      const itemEnCarrito = carrito.find(item => item.producto.id === idProducto);
      if (itemEnCarrito) {
        itemEnCarrito.cantidad++;
      } else {
        carrito.push({ producto, cantidad: 1 });
      }
      actualizarCarrito();
    }

    // Funci√≥n para actualizar el carrito y mostrar el detalle
    function actualizarCarrito() {
      detalleOrden.innerHTML = '';
      if (carrito.length === 0) {
        mensajeVacio.style.display = 'block';
        btnEnviarMesero.disabled = true;
        contadorOrden.textContent = '0';
        return;
      }
      mensajeVacio.style.display = 'none';
      btnEnviarMesero.disabled = false;

      carrito.forEach((item, index) => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = `
          <div>
            <strong>${item.producto.nombre}</strong> x${item.cantidad}
          </div>
          <div>
            $${(item.producto.precio * item.cantidad).toFixed(2)}
            <button class="btn btn-sm btn-outline-danger ms-3" aria-label="Eliminar ${item.producto.nombre}" title="Eliminar" onclick="eliminarDelCarrito(${index})">&times;</button>
          </div>
        `;
        detalleOrden.appendChild(li);
      });

      // Actualizar contador de productos (sumatoria de cantidades)
      const totalProductos = carrito.reduce((sum, item) => sum + item.cantidad, 0);
      contadorOrden.textContent = totalProductos;
    }

    // Funci√≥n para eliminar un producto del carrito
    function eliminarDelCarrito(index) {
      carrito.splice(index, 1);
      actualizarCarrito();
    }

    // Evento bot√≥n enviar pedido
    btnEnviarMesero.addEventListener('click', () => {
      if (carrito.length === 0) return alert('Tu pedido est√° vac√≠o.');

      // Aqu√≠ ir√≠a la l√≥gica para enviar el pedido al backend o procesarlo
      alert('Pedido enviado al mesero. ¬°Gracias por ordenar!');

      // Limpiar carrito tras enviar
      carrito = [];
      actualizarCarrito();

      // Cerrar modal autom√°ticamente
      const modalOrden = bootstrap.Modal.getInstance(document.getElementById('modalOrden'));
      modalOrden.hide();
    });

    // Inicializaci√≥n
    mostrarProductos();
    actualizarCarrito();

  </script>

</body>
</html>
